# sample configuration for iptables service
# you can edit this manually or use system-config-firewall
# please do not ask us to add additional ports/services to this default configuration
*filter
:INPUT DROP [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]

#localhost
-A INPUT -i lo -j ACCEPT

#Related And establshed connections
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m state --state NEW,RELATED,ESTABLISHED -m tcp --dport 9621 -j ACCEPT

#SSH Server
-A INPUT -s 159.122.20.154 -j ACCEPT
-A INPUT -s 10.71.60.57 -j ACCEPT

#Varnish Server
-A INPUT -s {{ web_pub_ip }} -j ACCEPT

#Cloudflare IPs
-A INPUT -s  103.21.244.0/22 -j ACCEPT
-A INPUT -s  103.22.200.0/22   -j ACCEPT
-A INPUT -s  103.31.4.0/22       -j ACCEPT
-A INPUT -s  104.16.0.0/12       -j ACCEPT
-A INPUT -s  108.162.192.0/18 -j ACCEPT
-A INPUT -s  131.0.72.0/22       -j ACCEPT
-A INPUT -s  141.101.64.0/18   -j ACCEPT
-A INPUT -s  162.158.0.0/15     -j ACCEPT
-A INPUT -s  172.64.0.0/13       -j ACCEPT
-A INPUT -s  173.245.48.0/20   -j ACCEPT
-A INPUT -s  188.114.96.0/20   -j ACCEPT
-A INPUT -s  190.93.240.0/20   -j ACCEPT
-A INPUT -s  197.234.240.0/22 -j ACCEPT
-A INPUT -s  198.41.128.0/17   -j ACCEPT

COMMIT
